@use "themes" as t;
@use "mixins";
@use "utilities";

.project-analyses-widget {
  padding-top: t.$padding-m;
  border: t.$border-width-m transparent solid;

  &.dragover-active {
    border-color: t.$primary-color;
  }

  .create-analyses-controls {
    gap: t.$padding-m;

    button {
      display: inline-flex;
      background-color: t.$secondary-button-dark-background-color;
      padding: t.$padding-s t.$padding-m;
      border-radius: t.$border-radius-s;

      &:hover {
        background-color: t.$secondary-button-dark-hover-background-color;
      }

      svg {
        width: 16px;
        height: 16px;
      }
    }
  }

  ul {
    list-style: none;
    padding: 0 0 t.$padding-m 0;

    li {
      display: flex;
      align-items: center;
      justify-content: space-between;

      &:hover {
        cursor: pointer;
        background-color: t.$secondary-button-hover-background-color;
      }

      .name {
        @include mixins.hide-text-overflow;
        flex-grow: 1;
      }

      button {
        all: unset;
        display: flex;
        align-items: center;
        padding: t.$padding-s;
        box-sizing: border-box;
      }
    }
  }
}

.delete-project-widget {
  .project-name {
    text-align: center;
    font-family: t.$title-font-family;
    font-weight: bold;
  }
}

.syre-ui-page-overlay:has(.excel-template-builder) {
  height: 100%;
  overflow-y: auto;

  .page-overlay-content {
    height: 100%;
  }
}

.excel-template-builder-wrapper {
  h1 {
    margin: 0;
    padding: t.$padding-xxl 0;
  }
}

.excel-template-builder {
  height: 100%;
  overflow-y: auto;
  padding: t.$padding-xl;

  .builder-step {
    min-height: 100%;
    padding-bottom: 10%;
  }

  form {
    font-size: 1.25rem;
    line-height: 1.75rem;
  }

  .excel-template {
    .workbook {
      display: grid;

      .spreadsheets {
        display: grid;

        .spreadsheet {
          grid-column: 1;
          grid-row: 1;
          overflow: auto;

          &:not(.active) {
            visibility: hidden;
          }

          table {
            border-collapse: collapse;

            th,
            td {
              @include mixins.hide-text-overflow;
              padding: t.$padding-m t.$padding-xl;
              border: t.$border-width-m t.$background-accent-color solid;
            }

            thead th {
              cursor: pointer;
            }
          }

          :nth-child(1 of .replace-range) {
            border-style: double;
            border-left-color: t.$primary-color;
          }

          :nth-last-child(1 of .replace-range) {
            border-style: double;
            border-right-color: t.$primary-color;
          }

          th.replace-range {
            border-style: double;
            border-top-color: t.$primary-color;
          }

          tr:last-child .replace-range {
            border-style: double;
            border-bottom-color: t.$primary-color;
          }

          .header-row {
            filter: brightness(60%);
          }
        }
      }

      .spreadsheet-tabs {
        grid-column: 1;
        grid-row: 2;
        overflow-x: auto;

        .spreadsheet-tab {
          padding: t.$padding-s t.$padding-l;

          &.active {
            background-color: t.$background-accent-color;
          }
        }
      }
    }
  }

  .form-step.input-data-parameters {
	  .form-control label {
		  width: 45%;
		  min-width: 250px;
	  }
  }
}

.excel-template-editor {
  min-height: 100vh;

  .sidebar-nav {
    background-color: t.$background-color;

    nav ol {
      list-style: none;
      list-style-position: inside;
      padding: 0;
      margin: 0;

      li {
        padding: t.$padding-xl;
        font-size: t.$font-size-lg;
        line-height: t.$line-height-lg;

        &.active {
          background-color: t.$frame-background-color;
        }
      }
    }
  }

  .editor-content {
    padding: t.$padding-xl;

    form {
      .form-step {
        display: none;

        &.active {
          display: block;
        }
      }
    }

	.excel-template-editor-input-step {
		label {
			width: 40%;
		}
	}

	.excel-template-editor-output-step {
		div.form-control {
			width: 40%;

			input,
			textarea {
				width: 100%;
			}
		}
	}
  }
}
